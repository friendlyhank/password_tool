# 密码管理器

一个基于Go语言和Fyne框架开发的Mac桌面密码管理应用程序，提供安全、便捷的密码管理解决方案。

## 🚀 功能特性

### 核心功能
- 🔐 **安全加密**: 使用AES-GCM加密算法保护您的密码数据
- 🔑 **主密码保护**: 通过主密码控制对所有密码的访问
- 📱 **现代界面**: 基于Fyne框架的原生Mac应用界面
- 🗂️ **分类管理**: 支持密码分类，便于组织管理
- 🔍 **快速搜索**: 支持按标题、用户名、网址等字段搜索
- 💾 **本地存储**: 数据存储在本地SQLite数据库中，保护隐私

### 安全特性
- ⏰ **自动锁定**: 5分钟无操作自动锁定应用，保护数据安全
- 🎯 **活动监听**: 智能检测用户操作，包括键盘输入、鼠标点击等
- 🔒 **对话框管理**: 锁定时自动关闭所有对话框，防止界面混乱
- 🧹 **内存清理**: 锁定时自动清除内存中的敏感数据

### 用户体验
- 📋 **一键复制**: 快速复制账号密码到剪切板
- 🌐 **智能URL**: 自动识别并创建可点击的网址链接
- ✏️ **便捷编辑**: 直接在列表中编辑和删除密码条目
- 👁️ **密码显示**: 安全的密码显示/隐藏切换功能
- 🔄 **实时刷新**: 操作后自动刷新列表，保持数据同步

## 技术架构

### 核心组件

- **GUI层**: 使用Fyne v2框架构建原生Mac界面
- **加密层**: 基于golang.org/x/crypto实现AES-GCM加密
- **存储层**: 使用SQLite数据库进行本地数据存储
- **模型层**: 定义密码条目、分类等数据结构

### 安全特性

- **PBKDF2密钥派生**: 使用100,000次迭代从主密码派生加密密钥
- **随机盐值**: 每个主密码使用独立的32字节随机盐值
- **AES-GCM加密**: 提供认证加密，防止数据篡改
- **内存安全**: 敏感数据在内存中的生命周期最小化
- **自动锁定机制**: 5分钟无操作自动锁定，清除内存中的主密钥
- **智能活动检测**: 全面监听用户交互，包括键盘、鼠标、UI操作
- **对话框生命周期管理**: 确保锁定时正确关闭所有打开的对话框

## 安装和使用

### 构建应用

```bash
# 克隆项目
git clone <repository-url>
cd password_tool

# 安装依赖
go mod tidy

# 构建应用
go build -o password_tool

# 运行应用
./password_tool
```

### 首次使用

1. 启动应用后，系统会提示设置主密码
2. 输入一个强密码作为主密码（建议包含大小写字母、数字和特殊字符）
3. 确认密码后，应用将创建加密的本地数据库

### 日常使用

1. **登录应用**: 启动应用，输入主密码登录
2. **添加密码**: 使用"添加密码"按钮创建新的密码条目
3. **查看详情**: 点击列表中的标题或用户名查看密码详情
4. **快速搜索**: 使用搜索框快速查找特定密码
5. **编辑管理**: 在列表中直接编辑或删除密码条目
6. **复制密码**: 使用"复制"按钮快速复制账号密码到剪切板
7. **访问网站**: 点击URL链接直接在浏览器中打开网站
8. **自动锁定**: 5分钟无操作后应用自动锁定，保护数据安全

### 界面功能说明

#### 主界面
- **密码列表**: 显示所有密码条目，支持按标题排序
- **搜索框**: 实时搜索密码条目，支持标题、用户名、网址、分类
- **操作按钮**: 每个条目提供复制、编辑、删除功能
- **URL链接**: 自动识别网址并创建可点击链接

#### 密码详情
- **信息展示**: 完整显示密码条目的所有信息
- **密码切换**: 点击"显示密码"按钮切换密码显示/隐藏
- **安全关闭**: 查看完毕后安全关闭详情窗口

#### 安全机制
- **自动锁定**: 检测到5分钟无用户操作时自动锁定
- **活动监听**: 监听键盘输入、鼠标点击、UI交互等用户活动
- **智能重置**: 任何用户操作都会重置锁定计时器
- **安全清理**: 锁定时自动清除内存中的敏感数据和关闭对话框

## 数据存储

应用数据存储在用户主目录下的`.password_tool`文件夹中：

```
~/.password_tool/
└── passwords.db  # SQLite数据库文件
```

## 🔒 安全建议

1. **选择强主密码**: 主密码是保护所有数据的关键，请选择足够复杂的密码
2. **定期备份**: 建议定期备份`~/.password_tool/passwords.db`文件
3. **安全环境**: 在安全的环境中使用应用，避免在公共场所输入主密码
4. **利用自动锁定**: 应用会在5分钟无操作后自动锁定，无需手动关闭
5. **注意屏幕隐私**: 查看密码时注意周围环境，使用完毕及时隐藏密码
6. **定期更新**: 建议定期更新应用以获得最新的安全修复和功能改进

## 🛠️ 便捷脚本

项目提供了两个便捷脚本来简化应用管理：

### `run.sh` - 快速启动
```bash
./run.sh
```
- 自动编译并运行应用程序
- 显示编译状态和友好提示信息

### `clear_data.sh` - 数据清理
```bash
./clear_data.sh
```
- 安全清除所有密码数据
- 需要输入'YES'进行二次确认
- **注意**: 此操作不可撤销，请谨慎使用

详细的脚本使用说明请参考 [README_scripts.md](README_scripts.md)

## 依赖项

- [Fyne v2](https://fyne.io/) - 跨平台GUI框架
- [SQLite3](https://github.com/mattn/go-sqlite3) - 嵌入式数据库
- [golang.org/x/crypto](https://pkg.go.dev/golang.org/x/crypto) - Go加密库

## 许可证

本项目采用MIT许可证。详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## ⚠️ 注意事项

- 本应用仅在macOS上测试，其他平台可能需要额外配置
- **忘记主密码将无法恢复数据**，请务必妥善保管主密码
- 建议定期更新应用以获得最新的安全修复
- 自动锁定功能需要应用保持运行状态才能生效
- 复制到剪切板的密码可能被其他应用访问，请注意使用环境
- 数据库文件包含加密的敏感信息，请妥善保管备份文件

## 🔄 版本更新

### 最新版本特性
- ✅ 5分钟无操作自动锁定功能
- ✅ 智能用户活动检测
- ✅ 一键复制账号密码功能  
- ✅ 可点击URL链接支持
- ✅ 对话框生命周期管理
- ✅ 增强的安全性和用户体验

### 升级建议
- 从旧版本升级时，建议先备份数据库文件
- 新的自动锁定功能默认启用，无需额外配置
- 如遇到兼容性问题，可使用`clear_data.sh`重置数据后重新设置